<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asprients - Login/Signup</title>
<style>
:root{
  --bg:#f6f8fb; 
  --card:#ffffff;
  --muted:#6b7280;
  --accent:#6b21a8; 
  --accent-2:#0ea5b7;
  --glass: rgba(0,0,0,0.03); 
  --text:#0b1220;
}
body{
  margin:0; padding:0; height:100vh; font-family:Inter,sans-serif;
  background: var(--bg); color: var(--text);
  display:flex; justify-content:center; align-items:center;
}
.auth-container{
  width:380px; padding:50px 30px;
  background: var(--glass); backdrop-filter:blur(12px);
  border-radius:20px; box-shadow:0 15px 30px rgba(0,0,0,0.08);
  text-align:center; border:1px solid rgba(0,0,0,0.05);
  position:relative;
  transition:0.3s;
}
.auth-tabs{
  display:flex; justify-content:space-around; margin-bottom:35px;
}
.auth-tabs button{
  background:none; border:none; color:var(--text); font-weight:600; font-size:1.05em;
  cursor:pointer; padding:10px 0; position:relative; transition:0.3s;
}
.auth-tabs button.active::after{
  content:''; position:absolute; bottom:0; left:0; width:100%; height:3px;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  border-radius:5px;
}
form{ display:none; text-align:left; animation:fadeIn 0.4s ease forwards; }
form.active{ display:block; }
@keyframes fadeIn{ from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
.form-group{ margin-bottom:18px; }
.form-group label{ display:block; margin-bottom:6px; font-size:0.9em; font-weight:500; }
.form-group input{
  width:100%; padding:12px 14px; border-radius:10px; border:1px solid rgba(0,0,0,0.1);
  background: var(--card); color:var(--text);
  font-size:0.95em; box-shadow: inset 1px 1px 3px rgba(0,0,0,0.03);
  transition:0.3s;
}
.form-group input::placeholder{ color: var(--muted); }
.form-group input:focus{
  outline:none; border-color: var(--accent);
  box-shadow:0 0 6px var(--accent-2);
}
button.submit-btn{
  width:100%; padding:14px; border:none; border-radius:12px;
  font-weight:600; font-size:1em; cursor:pointer;
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  color:#fff; transition:0.3s; box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
button.submit-btn:hover{
  background: linear-gradient(90deg,var(--accent-2),var(--accent));
  transform:translateY(-2px);
}
.switch-link{ text-align:center; margin-top:12px; font-size:0.9em; }
.switch-link a{ color: var(--accent-2); font-weight:600; transition:0.3s; cursor:pointer;}
.switch-link a:hover{ color: var(--accent); }
#message{ text-align:center; margin-top:10px; font-weight:600; color:var(--accent); min-height:20px; }
@media(max-width:420px){ .auth-container{ width:90%; padding:40px 20px; } }
</style>

<link rel="icon" href="images/logo.png" type="image/png">

</head>
<body>

<div class="auth-container">
  <div class="auth-tabs">
    <button id="loginTab" class="active">Login</button>
    <button id="signupTab">Sign Up</button>
  </div>

  <!-- Login Form -->
  <form id="loginForm" class="active">
    <div class="form-group">
      <label for="loginEmail">Email</label>
      <input type="email" id="loginEmail" placeholder="Enter your email" required>
    </div>
    <div class="form-group">
      <label for="loginPassword">Password</label>
      <input type="password" id="loginPassword" placeholder="Enter password" required>
    </div>
    <button type="submit" class="submit-btn">Login</button>
    <div class="switch-link"><a id="forgotPassword">Forgot Password?</a></div>
    <div class="switch-link">Don't have an account? <a id="toSignup">Sign Up</a></div>
  </form>

  <!-- Sign Up Form -->
  <form id="signupForm">
    <div class="form-group">
      <label for="signupName">Fullname</label>
      <input type="text" id="signupName" placeholder="Enter full name" required>
    </div>
    <div class="form-group">
      <label for="signupEmail">Email</label>
      <input type="email" id="signupEmail" placeholder="Enter email" required>
    </div>
    <div class="form-group">
      <label for="signupPassword">Password</label>
      <input type="password" id="signupPassword" placeholder="Enter password" required>
    </div>
    <div class="form-group">
      <label for="signupConfirm">Confirm Password</label>
      <input type="password" id="signupConfirm" placeholder="Confirm password" required>
    </div>
    <button type="submit" class="submit-btn">Sign Up</button>
    <div class="switch-link">Already have an account? <a id="toLogin">Login</a></div>
  </form>

  <div id="message"></div>
</div>

<script type="module">
// Firebase
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDHRDRRm2KBmCuUf3qvTIRI5hO0aXFFx3w",
  authDomain: "asprients-95c1f.firebaseapp.com",
  projectId: "asprients-95c1f",
  storageBucket: "asprients-95c1f.firebasestorage.app",
  messagingSenderId: "453218332819",
  appId: "1:453218332819:web:5740173fa4d8156dae9d66"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginForm = document.getElementById('loginForm');
const signupForm = document.getElementById('signupForm');
const loginTab = document.getElementById('loginTab');
const signupTab = document.getElementById('signupTab');
const toSignup = document.getElementById('toSignup');
const toLogin = document.getElementById('toLogin');
const message = document.getElementById('message');

// Switch forms
function switchForm(form){
    if(form==='login'){
        loginForm.classList.add('active'); signupForm.classList.remove('active');
        loginTab.classList.add('active'); signupTab.classList.remove('active');
    } else{
        signupForm.classList.add('active'); loginForm.classList.remove('active');
        signupTab.classList.add('active'); loginTab.classList.remove('active');
    }
}
loginTab.addEventListener('click', ()=>switchForm('login'));
signupTab.addEventListener('click', ()=>switchForm('signup'));
toSignup.addEventListener('click', ()=>switchForm('signup'));
toLogin.addEventListener('click', ()=>switchForm('login'));

// Signup
signupForm.addEventListener('submit', async e=>{
    e.preventDefault();
    const name = document.getElementById('signupName').value.trim();
    const email = document.getElementById('signupEmail').value;
    const password = document.getElementById('signupPassword').value;
    const confirm = document.getElementById('signupConfirm').value;
    
    if(!name){ message.innerText="Fullname required"; return; }
    if(password!==confirm){ message.innerText="Passwords do not match"; return; }
    
    try{
        const userCredential = await createUserWithEmailAndPassword(auth,email,password);
        const user = userCredential.user;
        console.log("✅ User created:", user.uid);

        // Firestore document
        await setDoc(doc(db,"users",user.uid),{
            fullname: name,
            email: email,
            password: password,
            progress:{},
            overallProgress:0
        });
        console.log("✅ Firestore document created");
        
        message.innerText=`Signup Successful ✅ Welcome, ${name}`;
        switchForm('login');
    } catch(err){
        console.error("❌ Error:", err);
        message.innerText=err.message;
    }
});

// Login
loginForm.addEventListener('submit', async e=>{
    e.preventDefault();
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;
    try{
        const userCredential = await signInWithEmailAndPassword(auth,email,password);
        const user = userCredential.user;
        const docSnap = await getDoc(doc(db,"users",user.uid));
        const fullname = docSnap.exists()? docSnap.data().fullname : "User";
        localStorage.setItem("fullname",fullname);
        window.location.href = "home.html";
    } catch(err){ message.innerText=err.message; }
});

// Forgot password
document.getElementById("forgotPassword").addEventListener("click", async (e)=>{
  e.preventDefault();
  const email = document.getElementById("loginEmail").value;
  if(!email){ message.innerText="⚠️ Enter your email"; return; }
  try{
    await sendPasswordResetEmail(auth,email);
    message.innerText="📩 Password reset link sent! Please Check Spam Folder";
  } catch(err){ message.innerText="❌ "+err.message; }
});

// // Auth state
//  onAuthStateChanged(auth, user=>{
//   if(user) window.location.href="home.html";
//  });
</script>
</body>
</html>
